{"version":3,"file":"caroucssel.cjs.js","sources":["../../src/utils/cache.ts","../../src/utils/debounce.ts","../../src/utils/render.ts","../../src/utils/scrollbar.ts","../../src/caroucssel.ts"],"sourcesContent":["// The key of a WeakMap must be an object. There is no other type that matches\n// or is valid for @typescript-eslint.\n// eslint-disable-next-line @typescript-eslint/ban-types\ntype Reference = object;\n\ntype Storage = {\n\t[key: string]: unknown;\n};\n\nconst __CACHE = new WeakMap<Reference, Storage>();\n\n/**\n * Returns the cache entry by as specific key of a given reference. If the cache\n * is not filled and the key doesn't exisit, the factory function is called to\n * generate a value.\n * @param ref the reference\n * @param key the storage key\n * @param factory the factory function\n * @returns the cached value\n */\nexport function fromCache<T = unknown>(ref: Reference, key: string, factory: () => T): T {\n\tconst storage = __CACHE.get(ref) || {};\n\tif (key in storage) {\n\t\treturn storage[key] as T;\n\t}\n\n\tconst value = factory();\n\tstorage[key] = value;\n\t__CACHE.set(ref, storage);\n\treturn value;\n}\n\n/**\n * Explicitly writes a value into the cache.\n * @param ref the reference\n * @param key the storage key\n * @param value the value\n */\nexport function writeCache<T = unknown>(ref: Reference, key: string, value: T): void {\n\tconst storage = __CACHE.get(ref) || {};\n\tstorage[key] = value;\n\t__CACHE.set(ref, storage);\n}\n\n/**\n * Creates the cache entry by as specific key of a given reference.\n * @param ref the reference\n * @param key the storage key\n */\nexport function clearCache(ref: Reference, key: string): void {\n\tconst storage = __CACHE.get(ref);\n\tif (!storage) {\n\t\treturn;\n\t}\n\n\tstorage[key] = undefined;\n\tdelete(storage[key]);\n}\n\n/**\n * Clears the full cache by a given reference.\n * @param ref the reference.\n */\nexport function clearFullCache(ref: Reference): void {\n\t__CACHE.delete(ref);\n}\n\n/**\n * This exposes the cache instance for test environments. Otherwise it will be null.\n */\nexport const cacheInstance = (process.env.NODE_ENV === 'test') ? __CACHE : null;\n","// See: https://codeburst.io/throttling-and-debouncing-in-javascript-b01cad5c8edf\n\ntype Source = (...args: never[]) => unknown;\ntype Debounced<F extends Source> = (...args: Parameters<F>) => void;\n\nexport function debounce<F extends Source>(func: F, delay: number): Debounced<F> {\n\tlet timeout: ReturnType<typeof setTimeout> | null = null;\n\tconst debounced = (...args: Parameters<F>) => {\n\t\tif (timeout !== null) {\n      clearTimeout(timeout);\n\t\t}\n\n\t\ttimeout = setTimeout(() => func(...args), delay);\n\t};\n\n\treturn debounced;\n}\n","export function render<El = HTMLElement, Data = Record<string, unknown>>(\n\ttemplate: (data: Data) => string,\n\tdata: Data,\n): El | null {\n\tconst el = document.createElement('div');\n\tel.innerHTML = template(data);\n\n\tconst ref = el.firstElementChild;\n\tif (!ref) {\n\t\treturn null;\n\t}\n\n\treturn ref as unknown as El;\n}\n","import { clearCache, fromCache } from './cache';\n\n\nexport type ScrollbarDimensions = {\n\theight: number,\n};\n\nexport class Scrollbar {\n\n\tconstructor() {\n\t\twindow.addEventListener('resize', () => {\n\t\t\tclearCache(this, 'dimensions');\n\t\t});\n\t}\n\n\t// Inspired by https://gist.github.com/kflorence/3086552\n\tget dimensions(): ScrollbarDimensions {\n\t\treturn fromCache<ScrollbarDimensions>(this, 'dimensions', () => {\n\t\t\tconst inner = document.createElement('div');\n\t\t\tconst outer = document.createElement('div');\n\n\t\t\tdocument.body.appendChild(outer);\n\t\t\touter.style.position = 'absolute';\n\t\t\touter.style.top = '0px';\n\t\t\touter.style.left = '0px';\n\t\t\touter.style.visibility = 'hidden';\n\t\t\touter.appendChild(inner);\n\n\t\t\t// Disabled, not needed for current feature set.\n\t\t\t//\n\t\t\t// Calculate width:\n\t\t\t// inner.style.width = '100%';\n\t\t\t// inner.style.height = '200px';\n\t\t\t// outer.style.width = '200px';\n\t\t\t// outer.style.height = '150px';\n\t\t\t// outer.style.overflow = 'hidden';\n\t\t\t// w1 = inner.offsetWidth;\n\t\t\t// outer.style.overflow = 'scroll';\n\t\t\t// w2 = inner.offsetWidth;\n\t\t\t// w2 = (w1 === w2) ? outer.clientWidth : w2;\n\t\t\t// width = w1 - w2;\n\n\t\t\t// Calculate height:\n\t\t\tinner.style.width = '200px';\n\t\t\tinner.style.height = '100%';\n\t\t\touter.style.width = '150px';\n\t\t\touter.style.height = '200px';\n\t\t\touter.style.overflow = 'hidden';\n\n\t\t\tconst h1 = inner.offsetHeight;\n\t\t\touter.style.overflow = 'scroll';\n\t\t\tlet h2 = inner.offsetHeight;\n\t\t\th2 = (h1 === h2) ? outer.clientHeight : h2;\n\t\t\tconst height = h1 - h2;\n\n\t\t\tdocument.body.removeChild(outer);\n\n\t\t\treturn {\n\t\t\t\t// width,\n\t\t\t\theight,\n\t\t\t};\n\t\t});\n\t}\n\n}\n","import { ButtonOptions, ButtonParams, Configuration, Index, Options, Pages, PaginationParams } from './types';\nimport { clearCache, clearFullCache, fromCache, writeCache } from './utils/cache';\nimport { debounce } from './utils/debounce';\nimport { render } from './utils/render';\nimport { Scrollbar } from './utils/scrollbar';\n\n\n// Export all types\nexport * from './types';\n\n\nconst ID_NAME = (count: number) => `caroucssel-${count}`;\nconst ID_MATCH = /^caroucssel-[0-9]*$/;\n\nconst CACHE_KEY_INDEX = 'index';\nconst CACHE_KEY_ITEMS = 'items';\nconst CACHE_KEY_PAGES = 'pages';\nconst CACHE_KEY_PAGE_INDEX = 'page-index';\nconst CACHE_KEY_SCROLLBAR = 'scrollbar';\n\nconst VISIBILITY_OFFSET = 0.25;\n\nconst INVISIBLE_ELEMENTS = /^(link|meta|noscript|script|style|title)$/i;\n\nconst EVENT_SCROLL = 'scroll';\nconst EVENT_RESIZE = 'resize';\n\nconst DEFAULTS_BUTTON_PREVIOUS: Required<ButtonOptions> = {\n\tclassName: 'is-previous',\n\tlabel: 'Previous',\n\ttitle: 'Go to previous',\n};\n\nconst DEFAULTS_BUTTON_NEXT: Required<ButtonOptions> = {\n\tclassName: 'is-next',\n\tlabel: 'Next',\n\ttitle: 'Go to next',\n};\n\nconst DEFAULTS: Configuration = {\n\t// Buttons:\n\thasButtons: false,\n\tbuttonClassName: 'button',\n\tbuttonTemplate: ({ className, controls, label, title }: ButtonParams) => `\n\t\t<button type=\"button\" class=\"${className}\" aria-label=\"${label}\" title=\"${title}\" aria-controls=\"${controls}\">\n\t\t\t<span>${label}</span>\n\t\t</button>\n\t`,\n\tbuttonPrevious: DEFAULTS_BUTTON_PREVIOUS,\n\tbuttonNext: DEFAULTS_BUTTON_NEXT,\n\n\t// Pagination:\n\thasPagination: false,\n\tpaginationClassName: 'pagination',\n\tpaginationLabel: ({ index }) => `${index + 1}`,\n\tpaginationTitle: ({ index }) => `Go to ${index + 1}. page`,\n\tpaginationTemplate: ({ className, controls, pages, label, title }: PaginationParams) => `\n\t\t<ul class=\"${className}\">\n\t\t\t${pages.map((page, index) => {\n\t\t\t\tconst data = { index, page, pages };\n\t\t\t\tconst labelStr = label(data);\n\t\t\t\tconst titleStr = title(data);\n\t\t\t\treturn `<li>\n\t\t\t\t\t<button type=\"button\" aria-controls=\"${controls}\" aria-label=\"${titleStr}\" title=\"${titleStr}\">\n\t\t\t\t\t\t<span>${labelStr}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</li>`;\n\t\t\t}).join('')}\n\t\t</ul>\n\t`,\n\n\t// Scrollbars, set to true when use default scrolling behaviour\n\thasScrollbars: false,\n\tscrollbarsMaskClassName: 'caroucssel-mask',\n\n\t// filter\n\tfilterItem: () => true,\n\n\t// Hooks:\n\tonScroll: () => undefined,\n};\n\n\nlet __instanceCount = 0;\nlet __scrollbar: Scrollbar;\n\n\nexport class Carousel {\n\n\tpublic static resetInstanceCount(): void {\n\t\t// This can be used for testing purposes to reset the instance count which is\n\t\t// used to create unique id's.\n\t\tif (process.env.NODE_ENV === 'test') {\n\t\t\t__instanceCount = 0;\n\t\t}\n\t}\n\n\tprotected _el: Element;\n\n\tprotected _id: string;\n\n\tprotected _conf: Configuration;\n\n\tprotected _mask: HTMLDivElement | null = null;\n\n\tprotected _isSmooth = false;\n\n\tprotected _previous: HTMLButtonElement | null = null;\n\n\tprotected _next: HTMLButtonElement | null = null;\n\n\tprotected _pagination: HTMLElement | null = null;\n\n\tprotected _paginationButtons: HTMLButtonElement[] | null = null;\n\n\tconstructor(el: Element, options: Options = {}) {\n\t\tif (!el || !(el instanceof Element)) {\n\t\t\tthrow new Error(`Carousel needs a dom element but \"${(typeof el)}\" was passed.`);\n\t\t}\n\n\t\tthis._el = el;\n\n\t\t// Create a singleton instance of scrollbar for all carousel instances:\n\t\t__scrollbar = __scrollbar || new Scrollbar();\n\n\t\t// Count all created instances to create unique id, if given dom element\n\t\t// has no id-attribute:\n\t\t__instanceCount++;\n\t\tel.id = el.id || ID_NAME(__instanceCount);\n\t\tthis._id = el.id;\n\n\t\t// Mask will be rendered after scrollbar detection.\n\t\tthis._mask = null;\n\n\t\t// extend options and defaults:\n\t\tconst opts = { ...DEFAULTS, ...options };\n\t\tthis._conf = opts;\n\n\t\t// Render:\n\t\tthis._addButtons();\n\t\tthis._addPagination();\n\t\tthis._updateScrollbars();\n\n\t\t// Set initial index and set smooth scrolling:\n\t\tswitch (true) {\n\t\t\t// When index is a list:\n\t\t\tcase Array.isArray(options.index):\n\t\t\t\tthis.index = options.index as Index;\n\t\t\t\tbreak;\n\t\t\t// When index is a number, transfrom to list:\n\t\t\tcase !isNaN(options.index as number):\n\t\t\t\tthis.index = [options.index as number];\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._isSmooth = true;\n\n\t\t// Events:\n\t\t//\n\t\t// We disable @typescript-eslint/unbound-method here because we already bound\n\t\t// the functions while creating a debounced version. This would also cause\n\t\t// reference errors when tying to access these function references when used\n\t\t// with removeEventListeners() (see: destroy())\n\t\t//\n\t\t/* eslint-disable @typescript-eslint/unbound-method */\n\t\tthis._onScroll = debounce(this._onScroll.bind(this), 25);\n\t\tthis._onResize = debounce(this._onResize.bind(this), 25);\n\t\tel.addEventListener(EVENT_SCROLL, this._onScroll);\n\t\twindow.addEventListener(EVENT_RESIZE, this._onResize);\n\t\t/* eslint-enable @typescript-eslint/unbound-method */\n\t}\n\n\tget el(): Element {\n\t\treturn this._el;\n\t}\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget index(): Index {\n\t\treturn fromCache(this, CACHE_KEY_INDEX, () => {\n\t\t\tconst { el, items } = this;\n\t\t\tconst { length } = items;\n\t\t\tconst { clientWidth } = el;\n\t\t\tconst outerLeft = el.getBoundingClientRect().left;\n\n\t\t\tconst index: number[] = [];\n\t\t\tlet at = 0;\n\n\t\t\tfor (;at < length; at++) {\n\t\t\t\tconst item = items[at];\n\t\t\t\tconst rect = item.getBoundingClientRect();\n\t\t\t\tconst { width } = rect;\n\t\t\t\tlet { left } = rect;\n\t\t\t\tleft = left - outerLeft;\n\n\t\t\t\tif (left + width * VISIBILITY_OFFSET >= 0 &&\n\t\t\t\t\tleft + width * (1 - VISIBILITY_OFFSET) <= clientWidth) {\n\t\t\t\t\tindex.push(at);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (index.length === 0) {\n\t\t\t\t// If no index found, we return a [0] as default. This possibly happens\n\t\t\t\t// when the carousel is not attached to the DOM or is visually hidden (display: none).\n\t\t\t\treturn [0];\n\t\t\t}\n\n\t\t\treturn index as Index;\n\t\t});\n\t}\n\n\tset index(values: Index) {\n\t\tconst { el, items } = this;\n\t\tconst { length } = items;\n\n\t\tif (!Array.isArray(values) || !values.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet value = values[0] || 0;\n\t\tvalue = Math.max(Math.min(value, length - 1), 0);\n\n\t\tconst { scrollLeft } = el;\n\t\tconst from = { left: scrollLeft };\n\t\tconst to = { left: items[value].offsetLeft };\n\n\t\t// If the target item is the first visible element in the list, ignore\n\t\t// the possible offset to the left and scroll to the beginning of the list:\n\t\tif (value === this.pages[0][0]) {\n\t\t\tto.left = 0;\n\t\t}\n\n\t\tif (from.left === to.left) {\n\t\t\treturn;\n\t\t}\n\n\t\tclearCache(this, CACHE_KEY_INDEX);\n\n\t\tconst behavior = this._isSmooth ? 'smooth' : 'auto';\n\t\tel.scrollTo({ ...to, behavior });\n\t}\n\n\tget items(): HTMLElement[] {\n\t\treturn fromCache(this, CACHE_KEY_ITEMS, () => {\n\t\t\tconst { el, _conf: { filterItem } } = this;\n\t\t\tconst children = Array.from(el.children) as HTMLElement[];\n\n\t\t\treturn children\n\t\t\t\t.filter((item) => !INVISIBLE_ELEMENTS.test(item.tagName) && !item.hidden)\n\t\t\t\t.filter(filterItem);\n\t\t});\n\t}\n\n\tget pages(): Pages {\n\t\treturn fromCache(this, CACHE_KEY_PAGES, (): Pages => {\n\t\t\tconst { el, items } = this;\n\t\t\tconst { clientWidth: viewport } = el;\n\n\t\t\tif (viewport === 0) {\n\t\t\t\t// if the width of the carousel element is zero, we can not calculate\n\t\t\t\t// the pages properly and the carousel seems to be not visible. If\n\t\t\t\t// this is the case, we assume that each item is placed on a\n\t\t\t\t// separate page.\n\t\t\t\treturn items.map((item, index) => [index] as Index) as Pages;\n\t\t\t}\n\n\t\t\ttype Dataset = {\n\t\t\t\titem: HTMLElement;\n\t\t\t\tleft: number;\n\t\t\t\twidth: number;\n\t\t\t\tindex: number;\n\t\t\t};\n\n\t\t\tlet pages: Dataset[][] = [[]];\n\n\t\t\titems\n\t\t\t\t.map((item, index): Dataset => {\n\t\t\t\t\t// Create a re-usable dataset for each item:\n\t\t\t\t\tconst { offsetLeft: left, clientWidth: width } = item;\n\t\t\t\t\treturn { left, width, item, index };\n\t\t\t\t})\n\t\t\t\t.sort((a, b) => {\n\t\t\t\t\t// Create ordered list of items based on their visual ordering.\n\t\t\t\t\t// This may differ from the DOM ordering unsing css properties\n\t\t\t\t\t// like `order` in  flexbox or grid:\n\t\t\t\t\treturn a.left - b.left;\n\t\t\t\t})\n\t\t\t\t.forEach((item) => {\n\t\t\t\t\t// Calculate pages / page indexes for each item:\n\t\t\t\t\t//\n\t\t\t\t\t// The idea behind the calculation of the pages is to separate\n\t\t\t\t\t// the items by fitting them into the viewport of the carousel.\n\t\t\t\t\t// To behave correctly, we cannot divide the total length of the\n\t\t\t\t\t// carousel by the viewport to get the page indexes (naive approach).\n\t\t\t\t\t// However, since there may be items that are partially visible\n\t\t\t\t\t// on a page, but mathematically create a new page. The calculation\n\t\t\t\t\t// must start from this item again. This means that always the\n\t\t\t\t\t// first item on a page sets the basis for the calculation of\n\t\t\t\t\t// the following item and its belonging to the current or next\n\t\t\t\t\t// page:\n\t\t\t\t\tconst { left, width } = item;\n\n\t\t\t\t\tconst prevPage = pages[pages.length - 1];\n\t\t\t\t\tconst firstItem = prevPage[0];\n\t\t\t\t\tlet start = firstItem?.left || 0;\n\n\t\t\t\t\t// This is required for the first page. The first page always\n\t\t\t\t\t// needs to start from the left=0. Any offset from the\n\t\t\t\t\t// left of the first visual item needs to be ignored, otherwise\n\t\t\t\t\t// the calculation of visual pages is incorrect:\n\t\t\t\t\tif (prevPage === pages[0]) {\n\t\t\t\t\t\tstart = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t// At least 75% of the items needs to be in the page. Calculate\n\t\t\t\t\t// the amount of new pages to add. If value is 0, the current\n\t\t\t\t\t// item fits into the previous page:\n\t\t\t\t\tlet add = Math.floor(((left - start) + width * (1 - VISIBILITY_OFFSET)) / viewport);\n\n\t\t\t\t\twhile(add > 0) {\n\t\t\t\t\t\tpages.push([]);\n\t\t\t\t\t\tadd--;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst page = pages[pages.length - 1];\n\t\t\t\t\tpage.push(item);\n\t\t\t\t});\n\n\t\t\t// Remove empty pages: this might happen if items are wider than the\n\t\t\t// carousel viewport:\n\t\t\tpages = pages.filter((page) => page.length !== 0);\n\n\t\t\t// Restructure pages to only contain the index of each item:\n\t\t\treturn pages.map((page) => page.map(({ index }) => index) as Index) as Pages;\n\t\t});\n\t}\n\n\tget pageIndex(): number {\n\t\treturn fromCache(this, CACHE_KEY_PAGE_INDEX, () => {\n\t\t\tconst { el, items, index, pages } = this;\n\t\t\tconst outerLeft = el.getBoundingClientRect().left;\n\t\t\tconst { clientWidth } = el;\n\n\t\t\tlet visibles: number[] = index.reduce<number []>((acc, at) => {\n\t\t\t\tif (!items[at]) {\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\tlet { left, right } = items[at].getBoundingClientRect();\n\t\t\t\t// \"getBoundingClientRect()\" can return float numbers which\n\t\t\t\t// lead to an unwanted behavior when in the calculation with\n\t\t\t\t// \"clientWidth\" (not using floats). We use round here to\n\t\t\t\t// normalize those values...\n\t\t\t\tleft = Math.round(left - outerLeft);\n\t\t\t\tright = Math.round(right - outerLeft);\n\n\t\t\t\t// Remove items that partially hidden to the left or right:\n\t\t\t\tif (left < 0 || clientWidth < right) {\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\treturn acc.concat([at]);\n\t\t\t}, []);\n\n\t\t\t// There might be no possible candidates. This is the case when items\n\t\t\t// are wider than the element viewport. In this case we take the first\n\t\t\t// item which is currently visible in general (might be the only one):\n\t\t\tif (visibles.length === 0) {\n\t\t\t\tvisibles = [index[0]];\n\t\t\t}\n\n\t\t\t// Search for the visible item that is most aligned to the right. The\n\t\t\t// found item marks the current page...\n\t\t\tconst at = visibles.sort((a, b) => {\n\t\t\t\tconst rightA = items[a].getBoundingClientRect().right;\n\t\t\t\tconst rightB = items[b].getBoundingClientRect().right;\n\t\t\t\treturn rightB - rightA;\n\t\t\t})[0];\n\n\t\t\t// Find the page index where the current item index is located...\n\t\t\treturn pages.findIndex((page) => page.includes(at));\n\t\t});\n\t}\n\n\tdestroy(): void {\n\t\tconst { el } = this;\n\n\t\t// Remove created id if it was created by carousel:\n\t\tID_MATCH.test(el.id) && el.removeAttribute('id');\n\n\t\t// Remove buttons:\n\t\tthis._removeButtons();\n\n\t\t// Remove pagination:\n\t\tthis._removePagination();\n\n\t\t// Remove scrollbars:\n\t\tthis._removeScrollbars();\n\n\t\t// Remove events:\n\t\t//\n\t\t// We need to work the the function reference. Using .bind() would create a\n\t\t// new referenced instance of the callback function. We already created a\n\t\t// bound version of these function within the constructor.\n\t\t//\n\t\t/* eslint-disable @typescript-eslint/unbound-method */\n\t\tel.removeEventListener(EVENT_SCROLL, this._onScroll);\n\t\twindow.removeEventListener(EVENT_RESIZE, this._onResize);\n\t\t/* eslint-enable @typescript-eslint/unbound-method */\n\n\t\t// Clear cache:\n\t\tclearFullCache(this);\n\t}\n\n\tupdate(): void {\n\t\tclearFullCache(this);\n\n\t\tthis._updateButtons();\n\t\tthis._updatePagination();\n\t\tthis._updateScrollbars();\n\t}\n\n\tprotected _updateScrollbars(): void {\n\t\tconst { el , _conf: _options } = this;\n\t\tconst { hasScrollbars, scrollbarsMaskClassName } = _options;\n\t\tif (hasScrollbars) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet { height } = __scrollbar.dimensions;\n\n\t\tif (el.scrollWidth <= el.clientWidth) {\n\t\t\t// If the contents are not scrollable because their width are less\n\t\t\t// than the container, there will be no visible scrollbar. In this\n\t\t\t// case, the scrollbar height is 0:\n\t\t\theight = 0;\n\t\t}\n\n\t\tthis._mask = this._mask || (() => {\n\t\t\tconst mask = document.createElement('div');\n\t\t\tmask.className = scrollbarsMaskClassName;\n\t\t\tmask.style.overflow = 'hidden';\n\t\t\tmask.style.height = '100%';\n\t\t\tel.parentNode?.insertBefore(mask, this.el);\n\t\t\tmask.appendChild(el);\n\t\t\treturn mask;\n\t\t})();\n\n\t\tconst cachedHeight = fromCache<number | undefined>(this, CACHE_KEY_SCROLLBAR, () => undefined);\n\t\tif (height === cachedHeight) {\n\t\t\treturn;\n\t\t}\n\n\t\twriteCache(this, CACHE_KEY_SCROLLBAR, height);\n\n\t\tconst element = el as HTMLElement | SVGElement;\n\t\telement.style.height = `calc(100% + ${height}px)`;\n\t\telement.style.marginBottom = `${height * -1}px`;\n\t}\n\n\tprotected _removeScrollbars(): void {\n\t\tconst { _mask, el } = this;\n\t\tif (!_mask) {\n\t\t\treturn;\n\t\t}\n\n\t\t_mask.parentNode?.insertBefore(el, _mask);\n\t\t_mask.parentNode?.removeChild(_mask);\n\t\tel.removeAttribute('style');\n\n\t\tthis._mask = null;\n\t}\n\n\tprotected _addButtons(): void {\n\t\tconst { el, id, _conf: _options } = this;\n\t\tif (!_options.hasButtons) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { buttonTemplate, buttonClassName, buttonPrevious, buttonNext } = _options;\n\t\tconst controls = id;\n\t\t// Create button elements:\n\t\tconst [previous, next] = [\n\t\t\t{ ...DEFAULTS_BUTTON_PREVIOUS, ...buttonPrevious, controls, className: [buttonClassName, buttonPrevious.className].join(' ') },\n\t\t\t{ ...DEFAULTS_BUTTON_NEXT, ...buttonNext, controls, className: [buttonClassName, buttonNext.className].join(' ') },\n\t\t].map((params) => render<HTMLButtonElement, ButtonParams>(buttonTemplate, params))\n\n\n\t\tif (previous) {\n\t\t\tconst onPrevious = () => {\n\t\t\t\tconst { pages, pageIndex } = this;\n\t\t\t\tconst index = pages[pageIndex - 1] || pages[0];\n\t\t\t\tthis.index = index;\n\t\t\t};\n\n\t\t\tprevious.onclick = onPrevious;\n\t\t\tel.parentNode?.appendChild(previous);\n\t\t}\n\t\tthis._previous = previous;\n\n\t\tif (next) {\n\t\t\tconst onNext = () => {\n\t\t\t\tconst { pages, pageIndex } = this;\n\t\t\t\tconst index = pages[pageIndex + 1] || pages[pages.length - 1];\n\t\t\t\tthis.index = index;\n\t\t\t};\n\n\t\t\tnext.onclick = onNext;\n\t\t\tel.parentNode?.appendChild(next);\n\t\t}\n\t\tthis._next = next;\n\n\t\tthis._updateButtons();\n\t}\n\n\tprotected _updateButtons(): void {\n\t\tconst { _conf: _options } = this;\n\t\tif (!_options.hasButtons) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { pages, pageIndex, _previous, _next } = this;\n\n\t\tif (_previous) {\n\t\t\tconst firstPage = pages[pageIndex - 1];\n\t\t\tconst isFirstPage = firstPage === undefined;\n\t\t\t_previous.disabled = isFirstPage;\n\t\t}\n\n\t\tif (_next) {\n\t\t\tconst lastPage = pages[pageIndex + 1];\n\t\t\tconst isLastPage = lastPage === undefined;\n\t\t\t_next.disabled = isLastPage;\n\t\t}\n\t}\n\n\tprotected _removeButtons(): void {\n\t\tconst { _previous, _next } = this;\n\t\t[_previous, _next].forEach((button) => {\n\t\t\tif (!button) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tbutton.onclick = null;\n\t\t\tbutton.parentNode?.removeChild(button);\n\t\t});\n\t}\n\n\tprotected _addPagination(): void {\n\t\tconst { _conf: _options } = this;\n\t\tif (!_options.hasPagination) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { _mask, el, id, pages } = this;\n\t\tif (pages.length < 2) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { paginationTemplate, paginationClassName, paginationLabel, paginationTitle } = _options;\n\t\tconst pagination = render(paginationTemplate, {\n\t\t\tpages,\n\t\t\tcontrols: id,\n\t\t\tclassName: paginationClassName,\n\t\t\tlabel: paginationLabel,\n\t\t\ttitle: paginationTitle,\n\t\t});\n\n\t\tif (!pagination) {\n\t\t\treturn;\n\t\t}\n\n\t\t// @TODO: Add template for buttons:\n\t\tconst buttons = Array.from(pagination.querySelectorAll<HTMLButtonElement>('button'))\n\t\t\t.map((button, index) => {\n\t\t\t\tbutton.onclick = () => this.index = pages[index];\n\t\t\t\treturn button;\n\t\t\t});\n\n\t\tconst target = (_mask || el).parentNode;\n\t\ttarget?.appendChild(pagination);\n\t\tthis._pagination = pagination;\n\t\tthis._paginationButtons = buttons;\n\n\t\tthis._updatePagination();\n\t}\n\n\tprotected _updatePagination(): void {\n\t\tconst { _conf: _options } = this;\n\t\tif (!_options.hasPagination) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { pageIndex, _paginationButtons } = this;\n\t\tif (!_paginationButtons) {\n\t\t\treturn;\n\t\t}\n\n\t\t_paginationButtons.forEach((button, at) => button.disabled = (at === pageIndex));\n\t}\n\n\tprotected _removePagination(): void {\n\t\tconst { _pagination, _paginationButtons } = this;\n\t\t(_paginationButtons || []).forEach((button) => {\n\t\t\tbutton.onclick = null;\n\t\t\tbutton.parentNode?.removeChild(button);\n\t\t});\n\t\tthis._paginationButtons = null;\n\n\t\t_pagination && _pagination.parentNode?.removeChild(_pagination);\n\t\tthis._pagination = null;\n\t}\n\n\tprotected _onScroll(event: Event): void {\n\t\tclearCache(this, CACHE_KEY_INDEX);\n\t\tclearCache(this, CACHE_KEY_PAGE_INDEX);\n\n\t\tthis._updateButtons();\n\t\tthis._updatePagination();\n\n\t\tconst { index, _conf: { onScroll } } = this;\n\t\tonScroll && onScroll<Carousel>({ index, type: EVENT_SCROLL, target: this, originalEvent: event });\n\t}\n\n\tprotected _onResize(): void {\n\t\tclearCache(this, CACHE_KEY_PAGES);\n\t\tclearCache(this, CACHE_KEY_INDEX);\n\t\tclearCache(this, CACHE_KEY_PAGE_INDEX);\n\n\t\tthis._updateButtons();\n\t\tthis._removePagination();\n\t\tthis._addPagination();\n\t\tthis._updateScrollbars();\n\t}\n\n}\n"],"names":[],"mappings":"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"}