"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const t=new WeakMap;function e(e,s,i){const n=t.get(e)||{};if(s in n)return n[s];if(!i)return;const r=i();return n[s]=r,t.set(e,n),r}function s(e,s,i){const n=t.get(e)||{};n[s]=i,t.set(e,n)}function i(e,s){const i=t.get(e);i&&(i[s]=void 0,delete i[s])}function n(e){t.delete(e)}function r(t,e){const s=document.createElement("div");s.innerHTML=t(e);const i=s.firstElementChild;return i||null}const o={template:({className:t,controls:e,label:s,title:i})=>`\n\t\t<button type="button" class="${t}" aria-label="${s}" title="${i}" aria-controls="${e}">\n\t\t\t<span>${s}</span>\n\t\t</button>\n\t`,className:"button",nextClassName:"is-next",nextLabel:"Next",nextTitle:"Go to next",previousClassName:"is-previous",previousLabel:"Previous",previousTitle:"Go to previous"};function l(t){return t instanceof MouseEvent?t.clientX:0}const a={indicator:!1};var h,d;exports.UpdateType=void 0,(h=exports.UpdateType||(exports.UpdateType={})).SCROLL="scroll",h.RESIZE="resize",h.FORCED="forced",h.FEATURE="feature",exports.ScrollBehavior=void 0,(d=exports.ScrollBehavior||(exports.ScrollBehavior={})).AUTO="auto",d.SMOOTH="smooth";const c={template:({className:t,controls:e,pages:s,label:i,title:n})=>`\n\t\t<ul class="${t}">\n\t\t\t${s.map(((t,r)=>{const o={index:r,page:t,pages:s},l=i(o),a=n(o);return`<li>\n\t\t\t\t\t<button type="button" aria-controls="${e}" aria-label="${a}" title="${a}">\n\t\t\t\t\t\t<span>${l}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</li>`})).join("")}\n\t\t</ul>\n\t`,className:"pagination",label:({index:t})=>`${t+1}`,title:({index:t})=>`Go to ${t+1}. page`};class u{constructor(){window.addEventListener("resize",(()=>{i(this,"dims")}))}get dimensions(){return e(this,"dims",(()=>{const t=document.createElement("div"),e=document.createElement("div");document.body.appendChild(e),e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.appendChild(t),t.style.width="200px",t.style.height="100%",e.style.width="150px",e.style.height="200px",e.style.overflow="hidden";const s=t.offsetHeight;e.style.overflow="scroll";let i=t.offsetHeight;i=s===i?e.clientHeight:i;const n=s-i;return document.body.removeChild(e),{height:n}}))}}let p;const g={enabled:!0,className:"caroucssel-mask",tagName:"div"};class m{constructor(t={}){s(this,"conf",Object.assign(Object.assign({},g),t))}get name(){return"buildin:mask"}get el(){var t;return null!==(t=e(this,"mask"))&&void 0!==t?t:null}init(t){s(this,"prxy",t),p=null!=p?p:new u,this._render()}destroy(){this._remove(),n(this)}update(t){switch(t.type){case exports.UpdateType.RESIZE:case exports.UpdateType.FORCED:i(this,"hght"),this._render();break;default:this._render()}}_render(){const{enabled:t,className:i,tagName:n}=e(this,"conf");if(!t)return;const r=e(this,"prxy").el;let{height:o}=p.dimensions;r.scrollWidth<=r.clientWidth&&(o=0),e(this,"mask",(()=>{var t;const e=document.createElement(n);return e.className=i,e.style.overflow="hidden",e.style.height="100%",null===(t=r.parentNode)||void 0===t||t.insertBefore(e,r),e.appendChild(r),e}));o!==e(this,"hght")&&(s(this,"hght",o),r.style.height=`calc(100% + ${o}px)`,r.style.marginBottom=-1*o+"px")}_remove(){var t,s;const{el:i}=e(this,"prxy"),n=e(this,"mask");null===(t=null==n?void 0:n.parentNode)||void 0===t||t.insertBefore(i,n),null===(s=null==n?void 0:n.parentNode)||void 0===s||s.removeChild(n),i.removeAttribute("style")}}function v(t){return e(t,"inst")}class f{constructor(t,e){s(this,"inst",t),s(this,"feat",e)}get id(){return v(this).id}get el(){return v(this).el}get mask(){return v(this).mask}get index(){return v(this).index}set index(t){v(this).index=t}get items(){return v(this).items}get pages(){return v(this).pages}get pageIndex(){return v(this).pageIndex}update(t){var s;v(this).update(),(s=this,e(s,"feat")).forEach((e=>{e!==t&&e.update({type:exports.UpdateType.FEATURE})}))}}function x(t,e){let s=null;return(...i)=>{null!==s&&clearTimeout(s),s=setTimeout((()=>t(...i)),e)}}const y=/^caroucssel-[0-9]*$/,b=/^(link|meta|noscript|script|style|title)$/i;let _=0;const E={features:[],filterItem:()=>!0,onScroll:()=>{}};exports.Buttons=class{constructor(t={}){s(this,"conf",Object.assign(Object.assign({},o),t)),this._onPrev=this._onPrev.bind(this),this._onNext=this._onNext.bind(this)}get name(){return"buildin:buttons"}init(t){s(this,"prxy",t),this._render()}destroy(){this._remove(),n(this)}update(){this._render()}_render(){const t=e(this,"prxy"),s=e(this,"conf"),{el:i,mask:n,pages:o,pageIndex:l}=t,[a,h]=e(this,"btns",(()=>{const t=null!=n?n:i,{template:e,className:o,previousClassName:l,previousLabel:a,previousTitle:h,nextClassName:d,nextLabel:c,nextTitle:u}=s;return[{controls:i.id,label:c,title:u,className:[o,d].join(" "),handler:this._onNext},{controls:i.id,label:a,title:h,className:[o,l].join(" "),handler:this._onPrev}].map((s=>{var i,{handler:n}=s,o=function(t,e){var s={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(s[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(s[i[n]]=t[i[n]])}return s}(s,["handler"]);const l=r(e,o);return l?(l.addEventListener("click",n),null===(i=t.parentNode)||void 0===i||i.insertBefore(l,t.nextSibling),l):null}))}));if(a){const t=void 0===o[l+1];a.disabled=t}if(h){const t=void 0===o[l-1];h.disabled=t}}_remove(){e(this,"btns").forEach((t=>{var e;null==t||t.removeEventListener("click",this._onPrev),null==t||t.removeEventListener("click",this._onNext),null===(e=null==t?void 0:t.parentNode)||void 0===e||e.removeChild(t)}))}_onPrev(){const t=e(this,"prxy"),{pages:s,pageIndex:i}=t,n=s[i-1]||s[0];t.index=n}_onNext(){const t=e(this,"prxy"),{pages:s,pageIndex:i}=t,n=s[i+1]||s[s.length-1];t.index=n}},exports.Carousel=class{constructor(t,e={}){if(this.behavior=exports.ScrollBehavior.AUTO,!(t&&t instanceof Element))throw new Error(`Carousel needs a dom element but "${typeof t}" was passed.`);s(this,"element",t),_++,t.id=t.id||`caroucssel-${_}`,s(this,"id",t.id);const i=Object.assign(Object.assign({},E),e);s(this,"config",i);let n=null,r=[...i.features];const o=i.features.findIndex((t=>t instanceof m));o>-1&&([n]=r.splice(o,1)),null!=n||(n=new m),r=r.filter((t=>!(t instanceof m))),r=[n,...r],s(this,"mask",n);const l=new f(this,r);switch(s(this,"proxy",l),s(this,"feautres",r),r.forEach((t=>t.init(l))),!0){case Array.isArray(e.index):this.index=e.index;break;case!isNaN(e.index):this.index=[e.index]}this.behavior=exports.ScrollBehavior.SMOOTH,this._onScroll=x(this._onScroll.bind(this),25),this._onResize=x(this._onResize.bind(this),25),t.addEventListener("scroll",this._onScroll),window.addEventListener("resize",this._onResize)}static resetInstanceCount(){}get el(){return e(this,"element")}get mask(){var t;return null!==(t=e(this,"mask").el)&&void 0!==t?t:null}get id(){return e(this,"id")}get index(){return e(this,"index",(()=>{const{el:t,items:e}=this,{length:s}=e,{clientWidth:i}=t,n=t.getBoundingClientRect().left,r=[];let o=0;for(;o<s;o++){const t=e[o].getBoundingClientRect(),{width:s}=t;let{left:l}=t;l-=n,l+.25*s>=0&&l+.75*s<=i&&r.push(o)}return 0===r.length?[0]:r}))}set index(t){const{behavior:e,el:s,items:n}=this,{length:r}=n;if(!Array.isArray(t)||!t.length)return;let o=t[0]||0;o=Math.max(Math.min(o,r-1),0);const{scrollLeft:l}=s,a=l,h={left:n[o].offsetLeft};o===this.pages[0][0]&&(h.left=0),a!==h.left&&(i(this,"index"),s.scrollTo(Object.assign(Object.assign({},h),{behavior:e})))}get items(){return e(this,"items",(()=>{const{filterItem:t}=e(this,"config"),{el:s}=this;return Array.from(s.children).filter((t=>!b.test(t.tagName)&&!t.hidden)).filter(t)}))}get pages(){return e(this,"pages",(()=>{const{el:t,items:e}=this,{clientWidth:s}=t;if(0===s)return e.map(((t,e)=>[e]));let i=[[]];return e.map(((t,e)=>{const{offsetLeft:s,clientWidth:i}=t;return{left:s,width:i,item:t,index:e}})).sort(((t,e)=>t.left-e.left)).forEach((t=>{const{left:e,width:n}=t,r=i[i.length-1],o=r[0];let l=(null==o?void 0:o.left)||0;r===i[0]&&(l=0);let a=Math.floor((e-l+.75*n)/s);for(;a>0;)i.push([]),a--;i[i.length-1].push(t)})),i=i.filter((t=>0!==t.length)),i.map((t=>t.map((({index:t})=>t))))}))}get pageIndex(){return e(this,"page-index",(()=>{const{el:t,items:e,index:s,pages:i}=this,n=t.getBoundingClientRect().left,{clientWidth:r}=t;let o=s.reduce(((t,s)=>{if(!e[s])return t;let{left:i,right:o}=e[s].getBoundingClientRect();return i=Math.round(i-n),o=Math.round(o-n),i<0||r<o?t:t.concat([s])}),[]);0===o.length&&(o=[s[0]]);const l=o.sort(((t,s)=>{const i=e[t].getBoundingClientRect().right;return e[s].getBoundingClientRect().right-i}))[0];return i.findIndex((t=>t.includes(l)))}))}destroy(){const{el:t}=this;y.test(t.id)&&t.removeAttribute("id");e(this,"feautres").forEach((t=>t.destroy())),t.removeEventListener("scroll",this._onScroll),window.removeEventListener("resize",this._onResize),n(this)}update(){i(this,"index"),i(this,"items"),i(this,"pages"),i(this,"page-index");e(this,"feautres").forEach((t=>t.update({type:exports.UpdateType.FORCED})))}_onScroll(t){i(this,"index"),i(this,"page-index");e(this,"feautres").forEach((t=>t.update({type:exports.UpdateType.SCROLL})));const{index:s}=this;e(this,"config").onScroll({index:s,type:"scroll",target:this,originalEvent:t})}_onResize(){i(this,"pages"),i(this,"index"),i(this,"page-index");e(this,"feautres").forEach((t=>t.update({type:exports.UpdateType.RESIZE})))}},exports.Mask=m,exports.Mouse=class{constructor(t={}){s(this,"conf",Object.assign(Object.assign({},a),t)),this._onStart=this._onStart.bind(this),this._onDrag=this._onDrag.bind(this),this._onEnd=this._onEnd.bind(this)}get name(){return"buildin:mouse"}init(t){s(this,"prxy",t);const i=e(this,"conf"),{el:n}=t;n.style.cursor=i.indicator?"grab":"",n.addEventListener("mousedown",this._onStart,{passive:!0})}destroy(){n(this)}update(){}_onStart(t){var s;const i=e(this,"time");clearTimeout(i);const n=e(this,"conf"),r=e(this,"prxy"),o=r.el;e(this,"scrl",(()=>o.scrollLeft)),e(this,"posx",(()=>l(t))),e(this,"pgidx",(()=>r.pageIndex)),o.style.userSelect="none",o.style.scrollBehavior="auto",o.style.scrollSnapType="none",o.style.cursor=n.indicator?"grabbing":"",window.addEventListener("mousemove",this._onDrag,{passive:!0}),window.addEventListener("mouseup",this._onEnd,{passive:!0}),null===(s=n.onStart)||void 0===s||s.call(n,{originalEvent:t})}_onDrag(t){var s;const i=e(this,"conf"),{el:n}=e(this,"prxy"),r=e(this,"scrl"),o=e(this,"posx")-l(t);n.scrollLeft=r+o,null===(s=i.onDrag)||void 0===s||s.call(i,{originalEvent:t})}_onEnd(t){var n,r;const o=e(this,"prxy"),l=e(this,"conf"),a=e(this,"scrl"),h=e(this,"pgidx");i(this,"scrl"),i(this,"posx"),i(this,"pgidx");const d=o.el,c=Math.min(Math.max(100,.25*d.clientWidth),250),u=d.scrollLeft-a,p=Math.abs(u);d.style.removeProperty("user-select"),d.style.removeProperty("scroll-behavior"),d.style.cursor=l.indicator?"grab":"";let g=o.index;if(p>c){const t=u/p,e=Math.max(h+t,0);g=null!==(n=o.pages[e])&&void 0!==n?n:g}window.requestAnimationFrame((()=>{o.index=g}));s(this,"time",window.setTimeout((()=>{d.style.removeProperty("scroll-snap-type")}),1e3)),window.removeEventListener("mousemove",this._onDrag),window.removeEventListener("mouseup",this._onEnd),null===(r=l.onEnd)||void 0===r||r.call(l,{originalEvent:t})}},exports.Pagination=class{constructor(t={}){s(this,"conf",Object.assign(Object.assign({},c),t)),this._onClick=this._onClick.bind(this)}get name(){return"buildin:pagination"}init(t){s(this,"prxy",t),this._add()}destroy(){this._remove(),n(this)}update(t){switch(t.type){case exports.UpdateType.SCROLL:this._update();break;default:this._remove(),this._add()}}_add(){var t;const i=e(this,"prxy"),n=e(this,"conf"),{el:o,mask:l,pages:a}=i,h=null!=l?l:o;if(a.length<2)return;const{template:d,className:c,label:u,title:p}=n,g=r(d,{label:u,title:p,pages:a,className:c,controls:o.id});if(!g)return;const m=Array.from(g.querySelectorAll("button")).map((t=>(t.addEventListener("click",this._onClick,!0),t)));null===(t=h.parentNode)||void 0===t||t.appendChild(g),s(this,"pags",g),s(this,"btns",m),this._update()}_update(){const t=e(this,"prxy"),s=e(this,"btns"),{pageIndex:i}=t;s.forEach(((t,e)=>t.disabled=e===i))}_remove(){var t;const s=e(this,"pags"),n=e(this,"btns");null==n||n.forEach((t=>{var e;t.removeEventListener("click",this._onClick),null===(e=t.parentNode)||void 0===e||e.removeChild(t)})),null===(t=null==s?void 0:s.parentNode)||void 0===t||t.removeChild(s),i(this,"btns"),i(this,"pags")}_onClick(t){const s=e(this,"prxy"),i=e(this,"btns"),n=t.currentTarget,r=i.indexOf(n);s.index=s.pages[r]}},exports.version="1.0.0";
